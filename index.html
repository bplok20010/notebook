<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1, maximum-scale=1"
        />
        <meta name="description" content="quantitative finance in javascript" />
        <meta name="author" content="Jin Yang" />
        <meta
            name="keywords"
            content="notebook, quantlib.js, math, javascript, quant, quantitative, finance, quantitative finance, mathematical finance, calculus, linear algebra, statistcs, probability, fast fourier transform, interpolation, extrapolation, ode, cashflow, libor, eurlibor, usdlibor, instrument, capfloor, bond, option, swap, swaption, future, monte carlo, finite difference, lattice, equity, market model, short rate, volatility, stochastic process, term structure"
        />
        <meta
            name="google-site-verification"
            content="4IrXoRzLpuCL684J3Y19wWtY9W5KqlvwLH5EQuZh1-Q"
        />
        <title>quantlib.js notebook Â© 2020 Jin Yang</title>
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/@forevolve/bootstrap-dark@1.0.0-alpha.902/dist/css/toggle-bootstrap.min.css"
        />
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/@forevolve/bootstrap-dark@1.0.0-alpha.902/dist/css/toggle-bootstrap-dark.min.css"
        />
        <link
            rel="stylesheet"
            href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
        />
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/codemirror@5.52.0/lib/codemirror.css"
        />
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/codemirror@5.52.0/theme/base16-light.css"
        />
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/codemirror@5.52.0/theme/base16-dark.css"
        />
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"
            integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq"
            crossorigin="anonymous"
        />

        <!-- Twitter -->
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:site" content="@quantlibjs" />
        <meta name="twitter:creator" content="@quantlibjs" />
        <meta name="twitter:title" content="quantlib.js" />
        <meta
            name="twitter:description"
            content="quantitative finance in javascript"
        />
        <meta
            name="twitter:image"
            content="https://cdn.jsdelivr.net/npm/@quantlib/misc@latest/logo.jpg"
        />

        <!-- Facebook -->
        <meta
            property="og:url"
            content="https://quantlib.js.org/notebook/#hello.json"
        />
        <meta property="og:title" content="quantlib.js" />
        <meta
            property="og:description"
            content="quantitative finance in javascript"
        />
        <meta property="og:type" content="website" />
        <meta
            property="og:image"
            content="https://cdn.jsdelivr.net/npm/@quantlib/misc@latest/logo.jpg"
        />
        <meta
            property="og:image:secure_url"
            content="https://cdn.jsdelivr.net/npm/@quantlib/misc@latest/logo.jpg"
        />

        <script
            async
            src="https://www.googletagmanager.com/gtag/js?id=UA-87290595-6"
        ></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag() {
                dataLayer.push(arguments);
            }
            gtag("js", new Date());

            gtag("config", "UA-87290595-6");
        </script>
        <style>
            .CodeMirror {
                height: auto;
            }
            .row {
                border-color: #191d21;
                border-width: 0.5px;
                border-style: solid;
                padding-top: 2px;
                padding-bottom: 2px;
                margin-top: 2px;
                margin-bottom: 2px;
            }
        </style>
    </head>
    <body class="bootstrap-dark">
        <nav class="navbar sticky-top navbar-expand-lg navbar-themed">
            <div class="container">
                <a class="navbar-brand" href="/notebook">quantlib.js</a>
                <button
                    class="navbar-toggler"
                    type="button"
                    data-toggle="collapse"
                    data-target="#navbarSupportedContent"
                    aria-controls="navbarSupportedContent"
                    aria-expanded="false"
                    aria-label="Toggle navigation"
                >
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div
                    class="collapse navbar-collapse"
                    id="navbarSupportedContent"
                >
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item active">
                            <a class="nav-link" onclick="add('javascript');"
                                ><i class="fa fa-plus"></i
                            ></a>
                        </li>
                        <li class="nav-item active">
                            <a class="nav-link" onclick="runAll();"
                                ><i class="fa fa-fast-forward"></i
                            ></a>
                        </li>
                        <li class="nav-item active">
                            <a class="nav-link" onclick="clearAll();"
                                ><i class="fa fa-refresh"></i
                            ></a>
                        </li>
                        <li class="nav-item active">
                            <a class="nav-link" onclick="color();"
                                ><i class="fa fa-adjust"></i
                            ></a>
                        </li>
                        <li class="nav-item active">
                            <a
                                class="nav-link"
                                onclick="saveAs('notebook.json',toJSON());"
                                ><i class="fa fa-download"></i
                            ></a>
                        </li>
                    </ul>
                    <form class="form-inline">
                        <a
                            class="nav-link"
                            target="_blank"
                            href="/notebook/#hello.json"
                            >Tutorial</a
                        >
                        <div class="form-group">
                            <label class="custom-file">
                                <input
                                    type="file"
                                    id="file-input"
                                    class="custom-file-input"
                                />
                                <span class="custom-file-control"
                                    ><i class="fa fa-upload"></i
                                ></span>
                            </label>
                        </div>
                    </form>
                </div>
            </div>
        </nav>
        <div id="notebook" class="container"></div>
        <script
            src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
            integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
            crossorigin="anonymous"
        ></script>
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
            integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
            crossorigin="anonymous"
        ></script>
        <script src="https://cdn.jsdelivr.net/npm/@forevolve/bootstrap-dark@1.0.0-alpha.902/dist/js/bootstrap.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/codemirror@5.52.0/lib/codemirror.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/codemirror@5.52.0/mode/javascript/javascript.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/codemirror@5.52.0/mode/markdown/markdown.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/eval5@1.3.1/umd/eval5.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
        <script
            src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"
            integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz"
            crossorigin="anonymous"
        ></script>
        <script
            src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"
            integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI"
            crossorigin="anonymous"
        ></script>
        <script src="https://cdn.jsdelivr.net/npm/mathjs@6.6.1/dist/math.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/plotly.js-dist@1.52.3/plotly.min.js"></script>
        <script>
            var interpreter,
                counter = 0,
                cells = {},
                theme = "dark",
                color_enter = "#C1E0FF",
                light_leave = "#ffffff",
                dark_leave = "#191d21";
            function color() {
                "dark" === theme
                    ? ((theme = "light"),
                      $(".row").css("border-color", light_leave))
                    : ((theme = "dark"),
                      $(".row").css("border-color", dark_leave)),
                    $("body").removeClass();
                var t = "dark" === theme ? "bootstrap-dark" : "bootstrap";
                for (id in ($("body").addClass(t), cells))
                    cells[id].setOption("theme", `base16-${theme}`);
            }
            function getEditor(t, e) {
                var o = document.getElementById(t);
                return CodeMirror.fromTextArea(o, {
                    theme: `base16-${theme}`,
                    lineWrapping: !0,
                    mode: e
                });
            }
            function toggle(t) {
                "javascript" === cells[t].options.mode
                    ? cells[t].setOption("mode", "markdown")
                    : cells[t].setOption("mode", "javascript"),
                    $(`#cell${t} .fa-code`).length > 0
                        ? ($(`#cell${t} .fa-code`).addClass("fa-sticky-note-o"),
                          $(`#cell${t} .fa-code`).removeClass("fa-code"))
                        : ($(`#cell${t} .fa-sticky-note-o`).addClass("fa-code"),
                          $(`#cell${t} .fa-sticky-note-o`).removeClass(
                              "fa-sticky-note-o"
                          ));
            }
            function eye(t) {
                $(`#in${t}`).is(":visible")
                    ? ($(`#in${t}`).hide(),
                      $(`#cell${t} .fa-bars`).addClass("fa-ellipsis-v"),
                      $(`#cell${t} .fa-bars`).removeClass("fa-bars"))
                    : ($(`#in${t}`).show(),
                      $(`#cell${t} .fa-ellipsis-v`).addClass("fa-bars"),
                      $(`#cell${t} .fa-ellipsis-v`).removeClass(
                          "fa-ellipsis-v"
                      ),
                      setTimeout(function() {
                          cells[t].refresh();
                      }, 10));
            }
            function add(t) {
                var e = counter++,
                    o =
                        "javascript" === t
                            ? "fa fa-code"
                            : "fa fa-sticky-note-o";
                $("#notebook").append(
                    `<div id="cell${e}" class="row">\n<div class="col-1 px-0">\n<div class="btn-group pull-right" role="group">\n    <button type="button" class="btn btn-sm" onclick="toggle(${e})"><i class="${o}"></i></button>\n    <button type="button" class="btn btn-sm" onclick="eye(${e});"><i class="fa fa-bars"></i></button>\n    <button type="button" class="btn btn-sm" onclick="run(${e});"><i class="fa fa-play"></i></button>\n</div>\n</div>\n<div class="col-10">\n<div id="in${e}"><textarea id="edit${e}"></textarea></div>\n<div id="out${e}"></div>\n</div>\n<div class="col-1 px-0">\n<div class="btn-group" role="group">\n    <button type="button" class="btn btn-sm" onclick="$('#cell${e}').insertBefore($('#cell${e}').prev('.row'));"><i class="fa fa-angle-up"></i></button>\n    <button type="button" class="btn btn-sm" onclick="del(${e});"><i class="fa fa-trash-o"></i></button>\n    <button type="button" class="btn btn-sm" onclick="$('#cell${e}').insertAfter($('#cell${e}').next('.row'));"><i class="fa fa-angle-down"></i></button>\n</div>\n</div>\n</div>`
                );
                var n = getEditor(`edit${e}`, t);
                cells[e] = n;
            }
            function del(t) {
                $(`#cell${t}`).remove(), delete cells[t];
            }
            function toJSON() {
                var t = {},
                    e = $("#notebook .row");
                for (let l = 0; l < e.length; l++) {
                    var o = e[l].id.substr(4),
                        n = {};
                    (n.input = {
                        type: cells[o].options.mode,
                        source: cells[o].getValue()
                    }),
                        (n.show_editor = $(`#in${o}`).is(":visible")),
                        (n.output = {
                            type: "html",
                            content: $(`#out${o}`).html()
                        }),
                        (t[`${e[l].id}`] = n);
                }
                return JSON.stringify(t, null, "\t");
            }
            function saveAs(t, e) {
                var o = document.createElement("a");
                o.setAttribute(
                    "href",
                    "data:text/plain;charset=utf-8," + encodeURIComponent(e)
                ),
                    o.setAttribute("download", t),
                    (o.style.display = "none"),
                    document.body.appendChild(o),
                    o.click(),
                    document.body.removeChild(o);
            }
            function fromJSON(t) {
                for (cell in ((cells = []),
                (counter = 0),
                $("#notebook").empty(),
                t)) {
                    var e = parseInt(cell.substr(4), 10);
                    counter < e && (counter = e);
                    var o = t[cell].input.type,
                        n =
                            "javascript" === o
                                ? "fa fa-code"
                                : "fa fa-sticky-note-o";
                    $("#notebook").append(
                        `<div id="cell${e}" class="row">\n<div class="col-1 px-0">\n<div class="btn-group pull-right" role="group">\n    <button type="button" class="btn btn-sm" onclick="toggle(${e})"><i class="${n}"></i></button>\n    <button type="button" class="btn btn-sm" onclick="eye(${e});"><i class="fa fa-bars"></i></button>\n    <button type="button" class="btn btn-sm" onclick="run(${e});"><i class="fa fa-play"></i></button>\n</div>\n</div>\n<div class="col-10">\n<div id="in${e}"><textarea id="edit${e}"></textarea></div>\n<div id="out${e}">${t[cell].output.content}</div>\n</div>\n<div class="col-1 px-0">\n<div class="btn-group" role="group">\n    <button type="button" class="btn btn-sm" onclick="$('#cell${e}').insertBefore($('#cell${e}').prev('.row'));"><i class="fa fa-angle-up"></i></button>\n    <button type="button" class="btn btn-sm" onclick="del(${e});"><i class="fa fa-trash-o"></i></button>\n    <button type="button" class="btn btn-sm" onclick="$('#cell${e}').insertAfter($('#cell${e}').next('.row'));"><i class="fa fa-angle-down"></i></button>\n</div>\n</div>\n</div>`
                    );
                    var l = getEditor(`edit${e}`, o);
                    l.setValue(t[cell].input.source),
                        setTimeout(function() {
                            l.refresh();
                        }, 10),
                        (cells[e] = l),
                        t[cell].show_editor || eye(e);
                }
                $(".btn-group").hide(), hover(), counter++;
            }
            function hover() {
                $(document).on(
                    {
                        mouseenter: function() {
                            $(this)
                                .find(".btn-group")
                                .show(),
                                $(this).css({ "border-color": "#C1E0FF" });
                        },
                        mouseleave: function() {
                            $(this)
                                .find(".btn-group")
                                .hide(),
                                $(this).css({
                                    "border-color":
                                        "dark" === theme ? "#191d21" : "#ffffff"
                                });
                        }
                    },
                    ".row"
                );
            }
            function readSingleFile(t) {
                var e = t.target.files[0];
                if (e) {
                    var o = new FileReader();
                    (o.onload = function(t) {
                        var e = t.target.result;
                        try {
                            fromJSON(JSON.parse(e));
                        } catch (t) {
                            console.log(t);
                        }
                    }),
                        o.readAsText(e);
                }
            }
            function load(t) {
                try {
                    fetch(t)
                        .then(t => t.json())
                        .then(t => {
                            fromJSON(t);
                        });
                } catch (t) {
                    console.log(t);
                }
            }
            function output(t, e) {
                if (void 0 !== t && void 0 !== t.type)
                    switch (t.type) {
                        case "plot":
                            Plotly.newPlot(
                                `ot${e}`,
                                t.data,
                                t.layout,
                                t.option
                            );
                            break;
                        case "table":
                            var o = `${t.data}`;
                            $(`#ot${e}`).append(o);
                            break;
                        case "text":
                            o = `<code>${t.data}</code>`;
                            $(`#ot${e}`).append(o);
                            break;
                        default:
                            o = `<code>${t}</code>`;
                            $(`#ot${e}`).append(o);
                    }
                else {
                    o = `<code>${t}</code>`;
                    $(`#ot${e}`).append(o);
                }
            }
            function print(t) {
                return { type: "text", data: t };
            }
            function table(t) {
                if (Array.isArray(t)) {
                    var e = '<table class="table table-striped">',
                        o = t[0];
                    for (td in ((e += "<thead><tr>"), o)) e += `<th>${td}</th>`;
                    e += "</tr></thead><tbody>";
                    for (let o = 0; o < t.length; o++) {
                        for (td in ((e += "<tr>"), t[o]))
                            e += `<td>${t[o][td]}</td>`;
                        e += "</tr>";
                    }
                    return { type: "table", data: (e += "</tbody></table>") };
                }
                return print(t);
            }
            function plot(t, e, o = { displaylogo: !1, responsive: !0 }) {
                return { type: "plot", data: t, layout: e, option: o };
            }
            function run(t) {
                $(`#out${t}`).empty(),
                    $(`#out${t}`).append(`<div id=ot${t}></div>`);
                var e = cells[t].getValue();
                if ("javascript" === cells[t].options.mode)
                    try {
                        output((o = interpreter.evaluate(`with(ql){${e}}`)), t);
                    } catch (n) {
                        console.log(n),
                            $(`#ot${t}`).append(`<code>${n.message}</code>`);
                    }
                else {
                    $(`#in${t}`).is(":visible") &&
                        ($(`#in${t}`).hide(),
                        $(`#cell${t} .fa-bars`).addClass("fa-ellipsis-v"),
                        $(`#cell${t} .fa-bars`).removeClass("fa-bars"));
                    try {
                        var o = marked(e);
                        $(`#out${t}`).append(`${o}`);
                        var n = document.getElementById(`out${t}`);
                        renderMathInElement(n, {
                            delimiters: [
                                { left: "$$", right: "$$", display: !0 },
                                { left: "\\[", right: "\\]", display: !0 },
                                { left: "$", right: "$", display: !1 },
                                { left: "\\(", right: "\\)", display: !1 }
                            ]
                        });
                    } catch (n) {
                        console.log(n),
                            $(`#out${t}`).append(`<pre>${n.message}</pre>`);
                    }
                }
            }
            function runAll() {
                var t = $("#notebook .row");
                for (let e = 0; e < t.length; e++) {
                    run(t[e].id.substr(4));
                }
            }
            function runMD() {
                var t = $("#notebook .row");
                for (let o = 0; o < t.length; o++) {
                    var e = t[o].id.substr(4);
                    0 === $(`#cell${e} .fa-code`).length && run(e);
                }
            }
            function runCode() {
                var t = $("#notebook .row");
                for (let o = 0; o < t.length; o++) {
                    var e = t[o].id.substr(4);
                    $(`#cell${e} .fa-code`).length > 0 && run(e);
                }
            }
            function clearAll() {
                var t = $("#notebook .row");
                for (let o = 0; o < t.length; o++) {
                    var e = t[o].id.substr(4);
                    $(`#out${e}`).empty(),
                        $(`#in${e}`).is(":visible") ||
                            ($(`#in${e}`).show(),
                            $(`#cell${e} .fa-ellipsis-v`).addClass("fa-bars"),
                            $(`#cell${e} .fa-ellipsis-v`).removeClass(
                                "fa-ellipsis-v"
                            ),
                            setTimeout(function() {
                                cells[e].refresh();
                            }, 10));
                }
            }
            function clearCode() {
                var t = $("#notebook .row");
                for (let o = 0; o < t.length; o++) {
                    var e = t[o].id.substr(4);
                    $(`#cell${e} .fa-code`).length > 0 &&
                        ($(`#out${e}`).empty(),
                        $(`#in${e}`).is(":visible") ||
                            ($(`#in${e}`).show(),
                            $(`#cell${e} .fa-ellipsis-v`).addClass("fa-bars"),
                            $(`#cell${e} .fa-ellipsis-v`).removeClass(
                                "fa-ellipsis-v"
                            )));
                }
            }
            function init() {
                document
                    .getElementById("file-input")
                    .addEventListener("change", readSingleFile, !1);
                var t = new marked.Renderer();
                (t.link = function(t, e, o) {
                    var n = marked.Renderer.prototype.link.apply(
                        this,
                        arguments
                    );
                    return n.replace("<a", "<a target='_blank'");
                }),
                    marked.setOptions({ renderer: t }),
                    import(
                        "https://cdn.jsdelivr.net/npm/@quantlib/ql@latest/ql.mjs"
                    ).then(t => {
                        var e = {
                            ql: t,
                            math: math,
                            plot: plot,
                            print: print,
                            table: table
                        };
                        interpreter = new eval5.Interpreter(e);
                        var o = window.location.hash;
                        "" !== o && load((o = o.substr(1))), hover();
                    });
            }
            init();
        </script>
    </body>
</html>
